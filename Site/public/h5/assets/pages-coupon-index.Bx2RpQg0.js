import{g as a,h as t,a as e,n as s,d as l,r as n,A as o,e as i,f as c,w as r,i as u,j as d,k as _,o as p,l as f,p as m,F as g,t as h,u as b,q as y,v}from"./index-CGszr9qB.js";import{_ as C}from"./uv-loading-page.DMunDfme.js";import{_ as T,r as k}from"./uni-app.es.CLj63pkI.js";import{_ as D}from"./uv-tabs.BBaBSH8a.js";import{_ as j}from"./uv-empty.BfD1VQnC.js";import"./uv-badge.C6BqFgsL.js";import"./uv-icon.40j6Cb1z.js";const w=T({data:()=>({theme:"",loading:!0,tabsTitle:[{name:"可领取"},{name:"可使用"},{name:"已使用"},{name:"已失效"}],currentTab:0,lineColor:"",dataList:[]}),onLoad(a){let t=this;Reflect.ownKeys(a).length>0&&a.hasOwnProperty("state")&&(t.currentTab=parseInt(a.state))},onShow(){let t=d(),e=a(),s={goods_id:0,url:e[e.length-1].route,platform:t.globalData.systemInfo.uniPlatform,model:t.globalData.systemInfo.deviceModel};this.$apis.visit.add(s),this.initData()},methods:{async initData(){let a,e=d(),s=this;await s.$onLaunched,s.theme=e.globalData.theme,s.lineColor=e.globalData.themeColor,a=await s.$apis.coupon.getList({state:s.currentTab}),s.dataList=a.data,t(),s.loading=!1},tabChange(a){this.currentTab=a.index,e({title:"加载中"}),this.initData()},turnUrl(a="",t=1){a&&"#"!=a&&(1==t&&s({url:a}),2==t&&l({url:a}),3==t&&n({url:a}))},getCoupon(a){let s=this;e({title:"加载中"}),s.$apis.coupon.saveData({uuid:a}).then((a=>{t(),0==a.code?o({title:"领取成功",icon:"success",duration:1500,success:()=>{setTimeout((()=>{s.initData()}),1500)}}):o({title:a.msg,icon:"none",duration:2e3})}))}}},[["render",function(a,t,e,s,l,n){const o=k(i("uv-loading-page"),C),d=k(i("uv-tabs"),D),T=_,w=k(i("uv-empty"),j);return p(),c(T,{class:u(["content",l.theme])},{default:r((()=>[f(o,{loading:l.loading},null,8,["loading"]),l.loading?b("",!0):(p(),m(g,{key:0},[f(T,{class:"header"},{default:r((()=>[f(T,{class:"header_ctt"},{default:r((()=>[f(d,{list:l.tabsTitle,current:l.currentTab,inactiveStyle:{color:"#999",transform:"scale(1)"},activeStyle:{color:"#333",transform:"scale(1.05)",fontWeight:"bold"},lineColor:l.lineColor,scrollable:!1,onChange:n.tabChange},null,8,["list","current","inactiveStyle","activeStyle","lineColor","onChange"])])),_:1})])),_:1}),f(T,{class:"wrap"},{default:r((()=>[f(T,{class:"space_header"}),f(T,{class:"m_ctr"},{default:r((()=>[f(T,{class:"space_ctr"}),(p(!0),m(g,null,h(l.dataList,((a,e)=>(p(),c(T,{class:"coupon_ctr",key:e},{default:r((()=>[f(T,{class:"coupon_left"},{default:r((()=>[f(T,{class:"coupon_title"},{default:r((()=>[y(v(a.title)+"("+v(a.use_type_title)+")",1)])),_:2},1024),f(T,{class:"coupon_price"},{default:r((()=>[f(T,null,{default:r((()=>[y("¥"+v(a.cut_price),1)])),_:2},1024),f(T,{class:"span"},{default:r((()=>[y("满"+v(a.min_price)+"元可用",1)])),_:2},1024)])),_:2},1024),f(T,{class:"coupon_date"},{default:r((()=>[y(v(a.b_date)+"-"+v(a.e_date),1)])),_:2},1024)])),_:2},1024),f(T,{class:"coupon_fg"}),f(T,{class:"coupon_right"},{default:r((()=>[0==l.currentTab?(p(),c(T,{key:0,class:"coupon_btn",onClick:t=>n.getCoupon(a.uuid)},{default:r((()=>[y("立即领取")])),_:2},1032,["onClick"])):b("",!0),1==l.currentTab?(p(),c(T,{key:1,class:"coupon_btn",onClick:t[0]||(t[0]=a=>n.turnUrl("/pages/index/index",2))},{default:r((()=>[y("去使用")])),_:1})):b("",!0),2==l.currentTab?(p(),c(T,{key:2,class:"coupon_btn_none"},{default:r((()=>[y("已使用")])),_:1})):b("",!0),3==l.currentTab?(p(),c(T,{key:3,class:"coupon_btn_none"},{default:r((()=>[y("已失效")])),_:1})):b("",!0)])),_:2},1024)])),_:2},1024)))),128)),l.dataList.length<1?(p(),c(T,{key:0,class:"none_ctr"},{default:r((()=>[f(w,{icon:"/static/images/none.png",text:"暂无相关优惠券"})])),_:1})):b("",!0)])),_:1})])),_:1})],64))])),_:1},8,["class"])}],["__scopeId","data-v-463c178e"]]);export{w as default};
