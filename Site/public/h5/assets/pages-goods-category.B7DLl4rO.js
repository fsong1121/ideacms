import{V as t,g as a,n as e,d as l,r as s,e as o,o as i,f as c,w as r,i as d,j as n,k as u,l as _,p as g,q as p,F as f,t as m,u as h,W as y,v as k,x as v}from"./index-CP7J3jEj.js";import{_ as x}from"./uv-loading-page.CzAcxD5Y.js";import{_ as w,r as L}from"./uni-app.es.CkShW-16.js";import{_ as b}from"./uv-icon.CCP1ZI1Q.js";import{_ as C}from"./uv-divider.B6-AYK5V.js";const N=w({data:()=>({theme:"",loading:!0,activeIndex:0,topNum:0,scrollW:0,numList:[],dataList:[],mobileSetting:{}}),onLoad(){t({success:t=>{this.scrollW=t.windowWidth>=750?750:t.windowWidth}})},onShow(){let t=n(),e=a(),l={goods_id:0,url:e[e.length-1].route,platform:t.globalData.systemInfo.uniPlatform,model:t.globalData.systemInfo.deviceModel};this.$apis.visit.add(l),this.initData()},methods:{async initData(){let t,a=n(),e=this;await e.$onLaunched,e.theme=a.globalData.theme,e.mobileSetting=a.globalData.mobileSetting,t=await e.$apis.goods.getCategory();let l=t.data,s=new Array,o=0,i=0;for(let c=0;c<l.length;c++)0==l[c].parent_id&&(s[o]=new Array,s[o].id=c,s[o].topNum=i,1==e.mobileSetting.category_type?i=i+50+Math.ceil(l[c].child_count/3)*((e.scrollW-130)/3+34):(t=await e.$apis.goods.getList({field:"id,title,pic,price,market_price,cat_id",cat:l[c].id,order:"is_top",size:500,page:1}),l[c].goodsList=t.data,i=i+50+Math.ceil(t.data.length/2)*((e.scrollW-130)/2+54)),o+=1);e.numList=s,e.dataList=l,e.loading=!1},changeNav(t){let a=this,e=t,l=a.topNum,s=a.numList;for(let o=0;o<s.length;o++)if(e==s[o].id){l=s[o].topNum;break}a.activeIndex=e,a.topNum=l},turnUrl(t="",a=1){t&&"#"!=t&&(1==a&&e({url:t}),2==a&&l({url:t}),3==a&&s({url:t}))},scrolltoupper(t){let a=this,e=a.numList,l=a.activeIndex;for(let s=0;s<e.length;s++)t.detail.scrollTop+1>e[s].topNum&&(l=e[s].id);a.activeIndex=l}}},[["render",function(t,a,e,l,s,n){const w=L(o("uv-loading-page"),x),N=L(o("uv-icon"),b),I=u,S=y,W=L(o("uv-divider"),C),j=v;return i(),c(I,{class:d(["content",s.theme])},{default:r((()=>[_(w,{loading:s.loading},null,8,["loading"]),s.loading?h("",!0):(i(),g(f,{key:0},[_(I,{class:"category_header"},{default:r((()=>[_(I,{class:"header_ctt"},{default:r((()=>[_(I,{class:"search_ctr",onClick:a[0]||(a[0]=t=>n.turnUrl("/pages/search/index"))},{default:r((()=>[_(I,{class:"search_ctt"},{default:r((()=>[_(I,{class:"search_ico"},{default:r((()=>[_(N,{name:"search","custom-prefix":"custom-icon"})])),_:1}),_(I,{class:"search_txt"},{default:r((()=>[p("试试输入您喜爱的商品搜一下")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),_(I,{class:"wrap"},{default:r((()=>[_(S,{class:"category_left","scroll-y":"true"},{default:r((()=>[(i(!0),g(f,null,m(s.dataList,((t,a)=>(i(),g(f,{key:a},[0==t.parent_id?(i(),g(f,{key:0},[s.activeIndex==a?(i(),c(I,{key:0,class:"category_left_cell_on",onClick:t=>n.changeNav(a)},{default:r((()=>[_(I,{class:"nav"},{default:r((()=>[p(k(t.title),1)])),_:2},1024)])),_:2},1032,["onClick"])):(i(),c(I,{key:1,class:"category_left_cell",onClick:t=>n.changeNav(a)},{default:r((()=>[_(I,{class:"nav"},{default:r((()=>[p(k(t.title),1)])),_:2},1024)])),_:2},1032,["onClick"]))],64)):h("",!0)],64)))),128))])),_:1}),_(S,{class:"category_right","scroll-y":"true",onScroll:n.scrolltoupper,"scroll-top":s.topNum,"scroll-with-animation":"true"},{default:r((()=>[(i(!0),g(f,null,m(s.dataList,((t,a)=>(i(),g(f,{key:a},[0==t.parent_id?(i(),c(I,{key:0,class:"category_right_title"},{default:r((()=>[_(W,{text:t.title,textColor:"#333"},null,8,["text"])])),_:2},1024)):h("",!0),1==s.mobileSetting.category_type?(i(),g(f,{key:1},[t.parent_id>0&&2==t.deep?(i(),c(I,{key:0,class:"category_right_ctr",onClick:a=>n.turnUrl("/pages/goods/list?id="+t.id)},{default:r((()=>[_(I,{class:"category_right_pic"},{default:r((()=>[_(j,{mode:"widthFix",src:t.pic},null,8,["src"])])),_:2},1024),_(I,{class:"category_right_txt"},{default:r((()=>[p(k(t.title),1)])),_:2},1024)])),_:2},1032,["onClick"])):h("",!0)],64)):(i(),g(f,{key:2},[0==t.parent_id?(i(),c(I,{key:0,class:"category_goods_ctr"},{default:r((()=>[(i(!0),g(f,null,m(t.goodsList,((t,a)=>(i(),c(I,{key:a,class:"category_goods_ctt",onClick:a=>n.turnUrl("/pages/goods/detail?id="+t.id)},{default:r((()=>[_(I,{class:"category_goods_pic"},{default:r((()=>[_(j,{mode:"widthFix",src:t.pic},null,8,["src"])])),_:2},1024),_(I,{class:"category_goods_t1"},{default:r((()=>[p(k(t.title),1)])),_:2},1024),_(I,{class:"category_goods_t2"},{default:r((()=>[_(I,null,{default:r((()=>[p("¥"+k(t.price),1)])),_:2},1024),_(I,{class:"span"},{default:r((()=>[p("¥"+k(t.market_price),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:2},1024)):h("",!0)],64))],64)))),128))])),_:1},8,["onScroll","scroll-top"])])),_:1})],64))])),_:1},8,["class"])}],["__scopeId","data-v-9e1d0bc0"]]);export{N as default};
