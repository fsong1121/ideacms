import{g as e,D as t,A as a,E as l,a as n,h as o,d as s,r as i,n as r,e as u,f as c,w as d,i as g,C as m,j as _,k as p,o as f,l as h,q as b,u as v,v as y,I as C,H as k,J as x}from"./index-qqngRkUa.js";import{_ as L,a as I}from"./uv-code.BIZvydD6.js";import{_ as D,r as S}from"./uni-app.es.DMzxE133.js";import{_ as w,a as $}from"./uv-checkbox-group.CE1ooxHf.js";import"./uv-icon.BH_bzOnD.js";const H=D({data:()=>({theme:"",themeColor:"",curLogin:0,smsLogin:0,otherLogin:0,tips:"",seconds:60,sending:0,tel:"",isAgree:1,checkboxValue:["agree"],backgroundStyle:{},navHeight:0,customNavWidth:0,customNavHeight:0,customNavTop:0}),onLoad(e){this.initData()},onShow(){let t=_(),a=e(),l={goods_id:0,url:a[a.length-1].route,platform:t.globalData.systemInfo.uniPlatform,model:t.globalData.systemInfo.deviceModel};this.$apis.visit.add(l)},methods:{async initData(){let e=_(),a=this;await a.$onLaunched,a.theme=e.globalData.theme,a.themeColor=e.globalData.themeColor,a.smsLogin=e.globalData.siteInfo.code_login,a.otherLogin=e.globalData.siteInfo.other_login;let l=0,n=0;Reflect.ownKeys(e.globalData.systemInfo).length>0&&(l=e.globalData.systemInfo.statusBarHeight,n=e.globalData.systemInfo.navHeight,a.navHeight=n,a.customNavWidth=e.globalData.systemInfo.boundingLeft,a.customNavHeight=e.globalData.systemInfo.boundingHeight,a.customNavTop=e.globalData.systemInfo.boundingTop);let o=-260;o=parseInt(o)+Number(parseInt((n+l)/(t(100)/100))),a.backgroundStyle={background:"url("+e.globalData.siteInfo.url+"/upload/pic/public/m_bg_"+e.globalData.theme+".png) left "+o+"rpx no-repeat #f6f6f6",backgroundSize:"100% auto"}},checkAgree(e){this.isAgree=e.length},changeLogin(){this.curLogin=0==this.curLogin?1:0},formSubmit(e){let t=this,r=t.isAgree;uni.$uv.throttle((function(u=e.detail.value){if(!r)return void a({title:"请同意用户协议",icon:"none",duration:2e3});if(""==u.m_uid||""==u.m_pwd)return void a({title:"用户名或密码为空",icon:"none",duration:2e3});if(!t.$refs.captcha.verification(u.m_code))return void a({title:"验证码错误",icon:"none",duration:2e3});let c=l("pid")||"";""==c&&(c=0),n({title:"注册中"});let d={m_uid:u.m_uid,m_pwd:u.m_pwd,m_code:u.m_code,pid:c};t.$apis.login.register(d).then((e=>{if(o(),0==e.code){let e=l("prevUrl")||"pages/user/index";e.indexOf("/cart/index")>0||e.indexOf("/user/index")>0?s({url:"/"+e}):i({url:"/"+e})}else a({title:e.msg,icon:"none",duration:2e3})}))}))},inputTel(e){this.tel=e.detail.value},codeChange(e){this.tips=e},getCode(){let e=this;uni.$uv.throttle((function(){let t=e.tel;if(e.$refs.code.canGetCode){if(!uni.$uv.test.mobile(t))return void a({title:"手机号错误",icon:"error"});n({title:"正在获取验证码"});let l={m_tel:t};e.$apis.login.sendSmsCode(l).then((t=>{0==t.code?(o(),a({title:"验证码已发送",icon:"none"}),e.$refs.code.start()):a({title:t.message,icon:"none"})}))}}))},end(){this.sending=0},start(){this.sending=1},smsSubmit(e){let t=this,r=t.isAgree;uni.$uv.throttle((function(u=e.detail.value){if(!r)return void a({title:"请同意用户协议",icon:"none",duration:2e3});if(""==u.m_tel||""==u.m_tel)return void a({title:"手机号或验证码为空！",icon:"none",duration:2e3});let c=l("pid")||"";""==c&&(c=0),n({title:"注册中"});let d={m_tel:u.m_tel,m_pwd:u.m_pwd,m_code:u.m_code,pid:c};t.$apis.login.smsCodeLogin(d).then((e=>{if(o(),0==e.code){let e=l("prevUrl")||"pages/user/index";e.indexOf("/cart/index")>0||e.indexOf("/user/index")>0?s({url:"/"+e}):i({url:"/"+e})}else a({title:e.msg,icon:"none",duration:2e3})}))}))},goBack(){s({url:"/pages/index/index"})},turnUrl(e="",t=1){e&&"#"!=e&&(1==t&&r({url:e}),2==t&&s({url:e}),3==t&&i({url:e}))}}},[["render",function(e,t,a,l,n,o){const s=p,i=C,r=S(u("jp-verification-literalness"),L),_=S(u("uv-checkbox"),w),D=S(u("uv-checkbox-group"),$),H=k,V=x,U=S(u("uv-code"),I);return f(),c(s,{class:g(["content",n.theme]),style:m(n.backgroundStyle)},{default:d((()=>[h(s,{class:"wrap"},{default:d((()=>[h(s,{class:"status_bar",style:m({paddingTop:n.navHeight+"px"})},null,8,["style"]),h(s,{class:"login_top"},{default:d((()=>[h(s,null,{default:d((()=>[b("欢迎您，")])),_:1}),h(s,null,{default:d((()=>[b("亲爱的家人们！")])),_:1})])),_:1}),h(s,{class:"m_ctr"},{default:d((()=>[h(s,{class:"yuan_ctr"},{default:d((()=>[h(s,{class:"login_title_ctr"},{default:d((()=>[h(s,{class:g({on:0==n.curLogin,"":1==n.curLogin}),onClick:t[0]||(t[0]=e=>o.changeLogin(0))},{default:d((()=>[b("账号注册")])),_:1},8,["class"]),1==n.smsLogin?(f(),c(s,{key:0,class:"fg"})):v("",!0),1==n.smsLogin?(f(),c(s,{key:1,class:g({on:1==n.curLogin,"":0==n.curLogin}),onClick:t[1]||(t[1]=e=>o.changeLogin(1))},{default:d((()=>[b("验证码注册")])),_:1},8,["class"])):v("",!0)])),_:1}),0==n.curLogin?(f(),c(V,{key:0,onSubmit:o.formSubmit},{default:d((()=>[h(s,{class:"input_title"},{default:d((()=>[b("账号：")])),_:1}),h(s,{class:"input_ctr"},{default:d((()=>[h(i,{name:"m_uid",placeholder:"请输入账号"})])),_:1}),h(s,{class:"input_title"},{default:d((()=>[b("密码：")])),_:1}),h(s,{class:"input_ctr"},{default:d((()=>[h(i,{name:"m_pwd",password:"true",placeholder:"请输入密码"})])),_:1}),h(s,{class:"input_title"},{default:d((()=>[b("验证码：")])),_:1}),h(s,{class:"input_ctr"},{default:d((()=>[h(s,{class:"get_code_ctr1"},{default:d((()=>[h(r,{ref:"captcha",contentHeight:35,contentWidth:100},null,512)])),_:1}),h(i,{name:"m_code",placeholder:"请输入验证码"})])),_:1}),h(s,{class:"agree_ctr",style:{"margin-top":"20rpx"}},{default:d((()=>[h(s,{class:"agree_ctt"},{default:d((()=>[h(D,{modelValue:n.checkboxValue,"onUpdate:modelValue":t[2]||(t[2]=e=>n.checkboxValue=e),shape:"circle",size:"14",activeColor:n.themeColor,onChange:o.checkAgree},{default:d((()=>[h(_,{name:"agree"})])),_:1},8,["modelValue","activeColor","onChange"]),h(s,null,{default:d((()=>[b("我已阅读并同意")])),_:1}),h(s,{onClick:t[3]||(t[3]=e=>o.turnUrl("/pages/article/agreement?type=user"))},{default:d((()=>[b("《用户协议》")])),_:1}),h(s,{onClick:t[4]||(t[4]=e=>o.turnUrl("/pages/article/agreement?type=privacy"))},{default:d((()=>[b("《隐私协议》")])),_:1})])),_:1})])),_:1}),h(H,{class:"login_btn",formType:"submit"},{default:d((()=>[b("立即注册")])),_:1})])),_:1},8,["onSubmit"])):v("",!0),1==n.curLogin?(f(),c(V,{key:1,onSubmit:o.smsSubmit},{default:d((()=>[h(s,{class:"input_title"},{default:d((()=>[b("手机号：")])),_:1}),h(s,{class:"input_ctr"},{default:d((()=>[h(i,{name:"m_tel",type:"number",onInput:o.inputTel,placeholder:"请输入11位手机号"},null,8,["onInput"])])),_:1}),h(s,{class:"input_title"},{default:d((()=>[b("密码：")])),_:1}),h(s,{class:"input_ctr"},{default:d((()=>[h(i,{name:"m_pwd",password:"true",placeholder:"请输入密码"})])),_:1}),h(s,{class:"input_title"},{default:d((()=>[b("验证码：")])),_:1}),h(s,{class:"input_ctr"},{default:d((()=>[h(s,{class:"get_code_ctr"},{default:d((()=>[h(U,{seconds:n.seconds,onEnd:o.end,onStart:o.start,ref:"code",onChange:o.codeChange},null,8,["seconds","onEnd","onStart","onChange"]),h(s,{class:g(0==n.sending?"get_code_btn":"get_code_btn_on"),onClick:o.getCode},{default:d((()=>[b(y(n.tips),1)])),_:1},8,["class","onClick"])])),_:1}),h(i,{name:"m_code",type:"number",placeholder:"请输入验证码"})])),_:1}),h(s,{class:"agree_ctr",style:{"margin-top":"20rpx"}},{default:d((()=>[h(s,{class:"agree_ctt"},{default:d((()=>[h(D,{modelValue:n.checkboxValue,"onUpdate:modelValue":t[5]||(t[5]=e=>n.checkboxValue=e),shape:"circle",size:"14",activeColor:n.themeColor,onChange:o.checkAgree},{default:d((()=>[h(_,{name:"agree"})])),_:1},8,["modelValue","activeColor","onChange"]),h(s,null,{default:d((()=>[b("我已阅读并同意")])),_:1}),h(s,{onClick:t[6]||(t[6]=e=>o.turnUrl("/pages/article/agreement?type=user"))},{default:d((()=>[b("《用户协议》")])),_:1}),h(s,{onClick:t[7]||(t[7]=e=>o.turnUrl("/pages/article/agreement?type=privacy"))},{default:d((()=>[b("《隐私协议》")])),_:1})])),_:1})])),_:1}),h(H,{class:"login_btn",formType:"submit"},{default:d((()=>[b("立即注册")])),_:1})])),_:1},8,["onSubmit"])):v("",!0),h(s,{class:"agree_ctr"},{default:d((()=>[h(s,{class:"agree_ctt",style:{"font-size":"28rpx"},onClick:t[8]||(t[8]=e=>o.turnUrl("/pages/user/login",3))},{default:d((()=>[b(" 已有账号，立即登录 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["class","style"])}],["__scopeId","data-v-8f142ce5"]]);export{H as default};
