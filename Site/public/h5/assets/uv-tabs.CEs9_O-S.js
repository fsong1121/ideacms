var e,t;import{E as s,G as i,e as a,o as r,f as l,w as n,l as o,Q as d,C as u,p as h,F as c,t as p,i as _,q as b,v,R as g,k as m,W as f}from"./index-ozoT3Rek.js";import{u as y,_ as w}from"./uv-badge.CBgzA-Mz.js";import{_ as $,r as S}from"./uni-app.es.Cr4agT_b.js";const x=$({name:"uv-tabs",emits:["click","change"],mixins:[s,i,{props:{duration:{type:Number,default:300},list:{type:Array,default:()=>[]},lineColor:{type:String,default:"#3c9cff"},activeStyle:{type:[String,Object],default:()=>({color:"#303133"})},inactiveStyle:{type:[String,Object],default:()=>({color:"#606266"})},lineWidth:{type:[String,Number],default:20},lineHeight:{type:[String,Number],default:3},lineBgSize:{type:String,default:"cover"},itemStyle:{type:[String,Object],default:()=>({height:"44px"})},scrollable:{type:Boolean,default:!0},current:{type:[Number,String],default:0},keyName:{type:String,default:"name"},...null==(t=null==(e=uni.$uv)?void 0:e.props)?void 0:t.tabs}}],data:()=>({firstTime:!0,scrollLeft:0,scrollViewWidth:0,lineOffsetLeft:0,tabsRect:{left:0},innerCurrent:0,moving:!1}),watch:{current:{immediate:!0,handler(e,t){e!==this.innerCurrent&&(this.innerCurrent=e,this.$nextTick((()=>{this.resize()})))}},list(){this.$nextTick((()=>{this.resize()}))}},computed:{textStyle(){return e=>{const t={},s=e===this.innerCurrent?this.$uv.addStyle(this.activeStyle):this.$uv.addStyle(this.inactiveStyle);return this.list[e].disabled&&(t.color="#c8c9cc"),this.$uv.deepMerge(s,t)}},propsBadge:()=>y},async mounted(){this.init()},methods:{setLineLeft(){const e=this.list[this.innerCurrent];if(!e)return;let t=this.list.slice(0,this.innerCurrent).reduce(((e,t)=>e+t.rect.width),0),s=this.$uv.getPx(this.lineWidth);this.$uv.test.number(this.lineWidth)&&this.$uv.unit&&(s=this.$uv.getPx(`${this.lineWidth}${this.$uv.unit}`)),this.lineOffsetLeft=t+(e.rect.width-s)/2,this.firstTime&&setTimeout((()=>{this.firstTime=!1}),20)},animation(e,t=0){},clickHandler(e,t){this.$emit("click",{...e,index:t}),e.disabled||(this.innerCurrent!=t&&this.$emit("change",{...e,index:t}),this.innerCurrent=t,this.$nextTick((()=>{this.resize()})))},init(){this.$uv.sleep().then((()=>{this.resize()}))},setScrollLeft(){const e=this.list[this.innerCurrent],t=this.list.slice(0,this.innerCurrent).reduce(((e,t)=>e+t.rect.width),0),s=this.$uv.sys().windowWidth;let i=t-(this.tabsRect.width-e.rect.width)/2-(s-this.tabsRect.right)/2+this.tabsRect.left/2;i=Math.min(i,this.scrollViewWidth-this.tabsRect.width),this.scrollLeft=Math.max(0,i)},resize(){0!==this.list.length&&Promise.all([this.getTabsRect(),this.getAllItemRect()]).then((([e,t=[]])=>{this.tabsRect=e,this.scrollViewWidth=0,t.map(((e,t)=>{this.scrollViewWidth+=e.width,this.list[t].rect=e})),this.setLineLeft(),this.setScrollLeft()}))},getTabsRect(){return new Promise((e=>{this.queryRect("uv-tabs__wrapper__scroll-view").then((t=>e(t)))}))},getAllItemRect(){return new Promise((e=>{const t=this.list.map(((e,t)=>this.queryRect(`uv-tabs__wrapper__nav__item-${t}`,!0)));Promise.all(t).then((t=>e(t)))}))},queryRect(e,t){return new Promise((t=>{this.$uvGetRect(`.${e}`).then((e=>{t(e)}))}))}}},[["render",function(e,t,s,i,y,$){const x=g,C=S(a("uv-badge"),w),k=m,R=f;return r(),l(k,{class:"uv-tabs",style:u([e.$uv.addStyle(e.customStyle)])},{default:n((()=>[o(k,{class:"uv-tabs__wrapper"},{default:n((()=>[d(e.$slots,"left",{},void 0,!0),o(k,{class:"uv-tabs__wrapper__scroll-view-wrapper"},{default:n((()=>[o(R,{"scroll-x":e.scrollable,"scroll-left":y.scrollLeft,"scroll-with-animation":"",class:"uv-tabs__wrapper__scroll-view","show-scrollbar":!1,ref:"uv-tabs__wrapper__scroll-view"},{default:n((()=>[o(k,{class:"uv-tabs__wrapper__nav",ref:"uv-tabs__wrapper__nav",style:u({flex:e.scrollable?"":1})},{default:n((()=>[(r(!0),h(c,null,p(e.list,((t,s)=>(r(),l(k,{class:_(["uv-tabs__wrapper__nav__item",[`uv-tabs__wrapper__nav__item-${s}`,t.disabled&&"uv-tabs__wrapper__nav__item--disabled"]]),key:s,onClick:e=>$.clickHandler(t,s),ref_for:!0,ref:`uv-tabs__wrapper__nav__item-${s}`,style:u([{flex:e.scrollable?"":1},e.$uv.addStyle(e.itemStyle)])},{default:n((()=>[o(x,{class:_([[t.disabled&&"uv-tabs__wrapper__nav__item__text--disabled"],"uv-tabs__wrapper__nav__item__text"]),style:u([$.textStyle(s)])},{default:n((()=>[b(v(t[e.keyName]),1)])),_:2},1032,["class","style"]),o(C,{show:!(!t.badge||!(t.badge.show||t.badge.isDot||t.badge.value)),isDot:t.badge&&t.badge.isDot||$.propsBadge.isDot,value:t.badge&&t.badge.value||$.propsBadge.value,max:t.badge&&t.badge.max||$.propsBadge.max,type:t.badge&&t.badge.type||$.propsBadge.type,showZero:t.badge&&t.badge.showZero||$.propsBadge.showZero,bgColor:t.badge&&t.badge.bgColor||$.propsBadge.bgColor,color:t.badge&&t.badge.color||$.propsBadge.color,shape:t.badge&&t.badge.shape||$.propsBadge.shape,numberType:t.badge&&t.badge.numberType||$.propsBadge.numberType,inverted:t.badge&&t.badge.inverted||$.propsBadge.inverted,customStyle:"margin-left: 4px;"},null,8,["show","isDot","value","max","type","showZero","bgColor","color","shape","numberType","inverted"])])),_:2},1032,["onClick","style","class"])))),128)),o(k,{class:"uv-tabs__wrapper__nav__line",ref:"uv-tabs__wrapper__nav__line",style:u([{width:e.$uv.addUnit(e.lineWidth),transform:`translate(${y.lineOffsetLeft}px)`,transitionDuration:`${y.firstTime?0:e.duration}ms`,height:y.firstTime?0:e.$uv.addUnit(e.lineHeight),background:e.lineColor,backgroundSize:e.lineBgSize}])},null,8,["style"])])),_:1},8,["style"])])),_:1},8,["scroll-x","scroll-left"])])),_:1}),d(e.$slots,"right",{},void 0,!0)])),_:3})])),_:3},8,["style"])}],["__scopeId","data-v-359a467b"]]);export{x as _};
